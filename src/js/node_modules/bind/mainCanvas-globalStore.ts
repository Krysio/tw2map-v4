import { GlobalStore } from "stores/global";
import { CanvasApi } from "canvas";
import { maps } from "common/MapColors";

/******************************/

export default function bindMainCanvasGlobalStore(
    mainCanvas: CanvasApi,
    globalStore: GlobalStore
) {
    let previosState = globalStore.getState();

    // set colors to canvas on change

    let unsubscriberStore = globalStore.subscribe(() => {
        let newState = globalStore.getState();

        if (newState['map'] !== previosState['map']) {
            // update colors map
            for (let key in maps.key2color) {
                let color = newState['map'][ key ];

                mainCanvas.commands.setColorInSlot(
                    maps.key2color[ key ].index,
                    color
                );
            }
        }

        previosState = newState;
    });
}