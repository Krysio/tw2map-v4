import Renderer from "map/Renderer";
import BuffersManager from "map/data/BuffersManager";
import Events from "map/Events";

/******************************/

export default function featureMapColor(
    events: Events,
    buffersManager: BuffersManager,
    renderer: Renderer
): void {
    let semafor = false;

    function update(): void {
        semafor = false;
        renderer.updateColors(buffersManager.getColorBuffer());
    }

    events.on('map/color', ({index, color}: {index: number, color: string}) => {
        buffersManager.setColor(index, color);

        if (!semafor) {
            semafor = true;
            update();
        }
    });
}