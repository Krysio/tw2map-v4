import Events from "data/Events";
import MapData from "data/data/MapData";
import commandLoadBaseData from "data/commands/loadBaseData";
import commandLoadRankingData from "data/commands/loadRankingData";
import commandLoadBackgroundData from "data/commands/loadBackgroundData";
import serviceSearch from "data/services/search";
import commandCleanData from "data/commands/clean";

/******************************/

export default function initData() {
    const events = new Events();
    const mapData = new MapData();

    if (process.env.NODE_ENV === 'development') {
        window['dev'] = window['dev'] || {};
        window['dev'].mapData = mapData;
    }

    return {
        events,

        getVillageByCoords: mapData.getVillageByCoords,
        getTileType: mapData.tileGetType,
        villageInterator: mapData.villageInterator, // TODO remove
        getVillageInterator: () => mapData.villageInterator(),
        getCharacterInterator: () => mapData.characterInterator(),
        getTribeInterator: () => mapData.tribeInterator(),
        getWorldDetails: () => mapData.world,
        getItem: mapData.getItem,

        commands: {
            ...commandLoadBaseData(events, mapData),
            ...commandLoadRankingData(events, mapData),
            ...commandLoadBackgroundData(events, mapData),
            ...commandCleanData(events, mapData),
            ...serviceSearch(mapData)
        }
    };
}
export type MapDataApi = ReturnType<typeof initData>;