import { Commands } from "canvas";
import BuffersManager from "canvas/data/BuffersManager";
import Renderer from "canvas/Renderer";

/******************************/

export default function commandSetColor(
    buffersManager: BuffersManager,
    renderer: Renderer,
    cmd: any
) {
    const commands = cmd as Commands;

    let semafor = false;

    function update(): void {
        semafor = false;
        renderer.updateColors(buffersManager.getColorBuffer());
    }

    return {
        setColorInSlot(
            index: number,
            color: string
        ): void {
            buffersManager.setColor(index, color);

            if (!semafor) {
                semafor = true;
                update();
            }
        }
    };
}