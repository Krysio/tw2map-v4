import * as React from 'react';
import { Modal, Header, Body, Footer, Hook } from "libs/ModalManager";
import LazyPromise from 'libs/LazyPromise';
import { ViewContext } from 'view/viewContext';
import SettingsBody from 'view/components/settings/SettingsBody';

/******************************/

export default function featureSettings(
    refContext: any
): (tab?: string) => Promise<string> {
    const context: ViewContext = refContext;
    const hook: Hook = context.modalSystem.createHook();
    const lazyPromise = new LazyPromise();

    hook.setLayout(
        <Modal
            hidden={ true }
            hideNotUnmount={ true }
        >
            <Header>
                Settings
            </Header>
            <Body
                className="p-2"
                style={{ minWidth: '20em' }}
            >
                <SettingsBody context={ context } hook={ hook } />
            </Body>
        </Modal>
    );

    function open(
        tab?: string
    ): Promise<string> {
        if (hook.isHidden()) {
            hook.show();
            hook.setCursorPosition();
        }

        return lazyPromise.get();
    }

    window['mSettings'] = hook;

    return open;
}